---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rtoml

<!-- badges: start -->
[![R-CMD-check](https://github.com/MarkPaulin/rtoml/actions/workflows/R-CMD-check.yaml/badge.svg)](https://github.com/MarkPaulin/rtoml/actions/workflows/R-CMD-check.yaml)
[![Codecov test coverage](https://codecov.io/gh/MarkPaulin/rtoml/graph/badge.svg)](https://app.codecov.io/gh/MarkPaulin/rtoml)
<!-- badges: end -->

rtoml is a wrapper around [tomlc17](https://github.com/cktan/tomlc17), a TOML parser written in C.

## Installation

You can install the development version of rtoml with:

```r
# install.packages("pak")
pak::pak("MarkPaulin/rtoml")
```

## Usage

Convert TOML documents into lists:

```{r}
library(rtoml)

x <- parse_toml('
title = "rtoml!"
today = 2025-12-30

[package]
status = "In development"

[package.todo]
dates = "Convert to R date types"
arrays = "Flatten them into vectors"
')

# or...
# x <- read_toml("file.toml")

str(x)
```

## Limitations

TOML has some features that aren't completely compatible with R. Some of these I'm planning on addressing, some of them are just not manageable at all. On top of those, this package will only read TOML - the underlying library doesn't support generating TOML files.

### Dates and times

TOML has four date- and time-related types. Base R doesn't have a type for times, but there are classes for dates and date-times. Currently, rtoml parses and dates, times, and date-times into custom types, but could be converted into more common types. Times could be optionally converted to `hms::hms()`.

RcppTOML converts dates into `Date`, and both local date-times and date-times to `POSIXct`, and times are converted to text. tomledit leaves all dates and times as text.

### Arrays and vectors

TOML supports arrays containing a mix of different types. Because of this, rtoml treats arrays as unnamed lists. R users probably expect an array all of the same type to be treated as a vector, which is what RcppTOML does. I just haven't figured out how to do that yet.

## Extra tests

I'm working on testing this against the [standard test suite](https://github.com/toml-lang/toml-test).
